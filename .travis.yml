dist: trusty
sudo: false
language: node_js
node_js:
- node
cache:
  directories:
  - node_modules
before_install:
- if [ -d node_modules ] && [ x$(cat node_modules/.last-node-version 2>/dev/null) != x$(node -e 'console.log(process.version)') ]; then npm rebuild --update-binary && node -e 'console.log(process.version)' > node_modules/.last-node-version; fi
script:
- npm run lint && npm test
deploy:
  provider: npm
  email: npm@collaborne.com
  api_key:
    secure: "e4/Jw8G7+inIG8yb3ExajQkbTEcP+icBSOx5iPxID0sJ+SXJ7NNKYGzTVS44lb4QyxQ64TE0dhXedsC+cK80vdjIcnEOS5gbwVH0EF+7TZ2XqVaKvSGhPFnvJOYQXV/ds/inorqaNFn08wnUMMBTOSrZwG9FlsjqxfZtzssA8E/NvUAgRSdOFfyxTm91Sao1YiqiOJT2tyRLOWf9LW21bJYKZ7ULZyGP0sdpPf1foNey5N/cZVCRCgxdJ+xHXozvRjAIpwzXKrY4rrANC2huhI3vsjxJ55mCMqGh51N+P42yvRyQxvSwTSyhNBCr/G7spDz4jf13oWuNLmGIAN0PvrOVvDQKKVeJcDA3mvoDRcpBWKU/KCj93vEjZBkhTwkZgzY/jg2V+5mW5XZnW+e8FsRwHzmk3BwtWR0i45ME9PjwsseBia2r5CbCjTbKk/hthrgRDkqFecIDfk2T/OOb6wkXYDxsrb7w2HC67zRJxxTJAe7pVrWpc9D+nO03sViDUUP7zcD9rZZOwVkvCIf/8dwWrFm7911zNbLjEVWUQbtInMsO8bBjmWbreVTO85YU2Gprb5YlHUYY0utjbQhBCDmjgu8GfgiW2T19tospQG2hT/lnbRxCRqkv7N0thzE9hi2peJ0joeh3oVZQIfYdb5CAo74Y3Asp2VIT4ySQwhs="
  on:
    tags: true
    condition: $(node -e 'console.log("v" + require("./package.json").version)') = ${TRAVIS_TAG}
  skip_cleanup: true
